<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>deliverMail</title>
<link href="../../../../../../images/logo-icon.svg" rel="icon" type="image/svg"><script>var pathToRoot = "../../../";</script><script type="text/javascript" src="../../../scripts/sourceset_dependencies.js" async="async"></script><link href="../../../styles/style.css" rel="Stylesheet"><link href="../../../styles/logo-styles.css" rel="Stylesheet"><link href="../../../styles/jetbrains-mono.css" rel="Stylesheet"><link href="../../../styles/main.css" rel="Stylesheet"><script type="text/javascript" src="../../../scripts/clipboard.js" async="async"></script><script type="text/javascript" src="../../../scripts/navigation-loader.js" async="async"></script><script type="text/javascript" src="../../../scripts/platform-content-handler.js" async="async"></script><script type="text/javascript" src="../../../scripts/main.js" async="async"></script><link href="../../../images/docs_logo.svg"><link href="../../../images/arrow_down.svg">  </head>
  <body>
    <div id="container">
      <div id="leftColumn"><a href="../../../index.html">
          <div id="logo"></div>
        </a>
        <div id="paneSearch"></div>
        <div id="sideMenu"></div>
      </div>
      <div id="main">
        <div id="leftToggler"><span class="icon-toggler"></span></div>
<script type="text/javascript" src="../../../scripts/main.js"></script>        <div class="main-content" id="content" pageIds="Conclave 1.1::com.r3.conclave.host/EnclaveHost/deliverMail/#kotlin.Long#kotlin.ByteArray#kotlin.String?#java.util.function.Function[kotlin.ByteArray,kotlin.ByteArray?]/PointingToDeclaration//-654294413">
          <div class="navigation-wrapper" id="navigation-wrapper">
            <div class="breadcrumbs"><a href="../../../index.html">Conclave 1.1</a>/<a href="../index.html">com.r3.conclave.host</a>/<a href="index.html">EnclaveHost</a>/<a href="deliver-mail.html">deliverMail</a></div>
            <div class="pull-right d-flex">
              <div id="searchBar"></div>
            </div>
          </div>
          <div class="cover ">
            <h1 class="cover"><span>deliver</span><wbr></wbr><span>Mail</span></h1>
          </div>
<div class="divergent-group" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="with-platform-tags"><span class="pull-right"></span></div>

  <div>
    <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-depenent-content" data-active="" data-togglable=":dokkaHtml/conclave"><div class="symbol monospace block"><span data-unresolved-link="/void///PointingToDeclaration/">void</span> <a href="deliver-mail.html">deliverMail</a>(<span data-unresolved-link="/long///PointingToDeclaration/">long</span> id, <span data-unresolved-link="/byte[]///PointingToDeclaration/">byte[]</span> mail, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a> routingHint, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Function.html">Function</a>&lt;<span data-unresolved-link="/byte[]///PointingToDeclaration/">byte[]</span>, <span data-unresolved-link="/byte[]///PointingToDeclaration/">byte[]</span>&gt; callback)<span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div></div></div>
  </div>
<p class="paragraph">Delivers the given encrypted mail bytes to the enclave. The enclave is required to override and implement <code>receiveMail</code> to receive it. If the enclave throws an exception it will be rethrown. It's up to the caller to decide what to do with mails that don't seem to be handled properly: discarding it and logging an error is a simple option, or alternatively queuing it to disk in anticipation of a bug fix or upgrade is also workable.</p><p class="paragraph">It's possible the callback provided to <a href="start.html">start</a> will receive a <a href="../-mail-command/-post-mail/index.html">MailCommand.PostMail</a> or <a href="../-mail-command/-acknowledge-mail/index.html">MailCommand.AcknowledgeMail</a> on the same thread, requesting mail to be sent back in response and/or acknowledgement, respectively. However, it's also possible the enclave will hold the mail without requesting any action.</p><p class="paragraph">When an enclave is started, you must redeliver, in order, any unacknowledged mail so the enclave can rebuild its internal state.</p><h2 class="">Parameters</h2><div data-togglable="Parameters"><div class="platform-hinted WithExtraAttributes" data-platform-hinted="data-platform-hinted" data-togglable="Parameters"><div class="content sourceset-depenent-content" data-active="" data-togglable=":dokkaHtml/conclave"><div data-togglable="Parameters"><div class="table" data-togglable="Parameters"><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">id</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">An identifier that will be used to identify acknowledged mail via <a href="../-mail-command/-acknowledge-mail/index.html">MailCommand.AcknowledgeMail</a>. The scope of this ID is up until the enclave acknowledges the mail, so it doesn't have to be fully unique forever, nor does it need to be derived from anything in particular. A good choice is a row ID in a database or a queue message ID, for example.</p></div></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">mail</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">The encrypted mail received from a remote client.</p></div></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">routingHint</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">An arbitrary bit of data identifying the sender on the host side. The enclave can pass this back through to <a href="../-mail-command/-post-mail/index.html">MailCommand.PostMail</a> to ask the host to deliver the reply to the right location.</p></div></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">callback</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">If the enclave calls <code>Enclave.callUntrustedHost</code> then the bytes will be passed to this object for consumption and generation of the response.</p></div></div></div></div></div></div></div></div></div></div><h4 class="">Throws</h4><div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-depenent-content" data-active="" data-togglable=":dokkaHtml/conclave"><div class="table"><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/UnsupportedOperationException.html">java.lang.UnsupportedOperationException</a></span></div><div><div class="title"><p class="paragraph">If the enclave has not provided an implementation for <code>receiveMail</code>.</p></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html">java.lang.IllegalStateException</a></span></div><div><div class="title"><p class="paragraph">If the host has not been started.</p></div></div></div></div></div></div></div></div>
<div class="divergent-group" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="with-platform-tags"><span class="pull-right"></span></div>

  <div>
    <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-depenent-content" data-active="" data-togglable=":dokkaHtml/conclave"><div class="symbol monospace block"><span data-unresolved-link="/void///PointingToDeclaration/">void</span> <a href="deliver-mail.html">deliverMail</a>(<span data-unresolved-link="/long///PointingToDeclaration/">long</span> id, <span data-unresolved-link="/byte[]///PointingToDeclaration/">byte[]</span> mail, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a> routingHint)<span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div></div></div>
  </div>
<p class="paragraph">Delivers the given encrypted mail bytes to the enclave. The enclave is required to override and implement <code>receiveMail</code> to receive it. If the enclave throws an exception it will be rethrown. It's up to the caller to decide what to do with mails that don't seem to be handled properly: discarding it and logging an error is a simple option, or alternatively queuing it to disk in anticipation of a bug fix or upgrade is also workable.</p><p class="paragraph">It's possible the callback provided to <a href="start.html">start</a> will receive a <a href="../-mail-command/-post-mail/index.html">MailCommand.PostMail</a> or <a href="../-mail-command/-acknowledge-mail/index.html">MailCommand.AcknowledgeMail</a> on the same thread, requesting mail to be sent back in response and/or acknowledgement, respectively. However, it's also possible the enclave will hold the mail without requesting any action.</p><p class="paragraph">When an enclave is started, you must redeliver, in order, any unacknowledged mail so the enclave can rebuild its internal state.</p><p class="paragraph">Note: The enclave does not have the option of using <code>Enclave.callUntrustedHost</code> for sending bytes back to the host. Use the overload which takes in a callback <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Function.html">Function</a> instead.</p><h2 class="">Parameters</h2><div data-togglable="Parameters"><div class="platform-hinted WithExtraAttributes" data-platform-hinted="data-platform-hinted" data-togglable="Parameters"><div class="content sourceset-depenent-content" data-active="" data-togglable=":dokkaHtml/conclave"><div data-togglable="Parameters"><div class="table" data-togglable="Parameters"><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">id</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">an identifier that will be used to identify acknowledged mail via <a href="../-mail-command/-acknowledge-mail/index.html">MailCommand.AcknowledgeMail</a>. The scope of this ID is up until the enclave acknowledges the mail, so it doesn't have to be fully unique forever, nor does it need to be derived from anything in particular. A good choice is a row ID in a database or a queue message ID, for example.</p></div></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">mail</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">the encrypted mail received from a remote client.</p></div></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">routingHint</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">An arbitrary bit of data identifying the sender on the host side. The enclave can pass this back through to <a href="../-mail-command/-post-mail/index.html">MailCommand.PostMail</a> to ask the host to deliver the reply to the right location.</p></div></div></div></div></div></div></div></div></div></div><h4 class="">Throws</h4><div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-depenent-content" data-active="" data-togglable=":dokkaHtml/conclave"><div class="table"><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/UnsupportedOperationException.html">java.lang.UnsupportedOperationException</a></span></div><div><div class="title"><p class="paragraph">If the enclave has not provided an implementation for <code>receiveMail</code>.</p></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/conclave" data-filterable-set=":dokkaHtml/conclave"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html">java.lang.IllegalStateException</a></span></div><div><div class="title"><p class="paragraph">If the host has not been started.</p></div></div></div></div></div></div></div></div>
        </div>
        <div class="footer"><span class="go-to-top-icon"><a href="#content"></a></span><span><a href="https://docs.conclave.net">&#60;&#60; Back to Conclave documentation</a></span><span class="pull-right"><span>Generated by </span><a href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span></div>
      </div>
    </div>
  </body>
</html>

